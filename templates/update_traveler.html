{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
        <title>NIWITRAVELS</title>
        <link rel="icon" href="{% static 'Niwi_Travels/images/favicon.ico' %}" type="image/x-icon">
        <link rel="stylesheet" href="{% static 'Niwi_Travels/css/style.css' %}">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
        <link rel="icon" href="{% static 'Niwi_Travels/images/favicon.ico' %}" type="image/x-icon">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <style>
            /* Add custom CSS styles here */
            .container {
            margin-top: 80px; /* Adjust the top margin to control the space below the navbar */
        }
        .profile-table input[type="text"],
.profile-table select {
    width: 100%;
    padding: 8px;
    margin: 5px 0;
    border: 1px solid #ccc;
    border-radius: 4px;
}

/* Style for the select element */
.profile-table select {
    height: 34px;
}

/* Style for the validation messages */
.profile-table .validation-message {
    color: #dc3545;
    font-size: 12px;
    margin-top: 5px;
}

/* Style for the Update Profile button */
.profile-table #update-profile-button {
    background-color: #007BFF;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    margin-top: 10px;
}

.profile-table #update-profile-button:hover {
    background-color: #0056b3;
}

.profile-table #update-profile-button:disabled {
    background-color: #ccc;
    cursor: not-allowed;
}
        .profile-table {
            width: 100%;
            max-width: 800px; /* Set a maximum width for the table */
            margin: 0 auto; /* Center the table horizontally */
            border-collapse: collapse;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .profile-table th, .profile-table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }

        .profile-table th {
            background-color: #050505;
            color: #fff;
        }

        .profile-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        .profile-table tr:hover {
            background-color: #ddd;
        }

        .profile-table img {
            max-width: 100px; /* Limit the width of profile photos */
            height: auto;
            display: block;
            margin: 0 auto; /* Center the profile photos */
        }

        .text-dark {
            color: #000000; /* Dark text color */
        }
        </style>
        
      </head>
      <body data-spy="scroll" data-target=".site-navbar-target" data-offset="300">
    
        <nav class="navbar navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light site-navbar-target" id="ftco-navbar">
            <div class="container">
                <img src="{% static 'Niwi_Travels/images/niwilogo.jpg' %}" alt="Logo" width="40px" height="35px"> <a class="navbar-brand" href="#">NIWI TRAVELS</a>

    
              <div class="collapse navbar-collapse" id="ftco-nav">
                <ul class="navbar-nav nav ml-auto">
                    
                  <li class="nav-item"><a href="/thome" class="nav-link"><span style="color: #fff;">Home</span></a></li>
                  <li class="nav-item dropdown">
                    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" style="color: #fff;">
                        {{ user.username }}
                    </a>
                    <div class="dropdown-menu dropdown-menu-right">
                        <a class="dropdown-item" href="/upcoming-journeys" id="#" style=" background-color: rgb(42, 165, 67);text-align: center;">Upcoming Journeys</a>
                        <a class="dropdown-item" href="/ongoing-journeys" id="#" style=" background-color: rgb(218, 180, 13);text-align: center;">Ongoing Trips</a>
                        <a class="dropdown-item" href="/history-journeys" id="#" style=" background-color: rgb(234, 0, 0);text-align: center;">History</a>
                        <a class="dropdown-item" href="/viewprofileT" style=" background-color: rgb(151, 140, 245);text-align: center;">View Profile</a>
                        <a class="dropdown-item" href="/tupdate" id="#" style=" background-color: rgb(195, 67, 172);text-align: center;">Update Profile</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="/logout" id="logout-link" style="color: rgb(255, 0, 0); background-color: rgb(40, 38, 38); text-align: center;">Logout</a>
                    </div>
                </li>
                </ul>
                
              </div>
            </div>
          </nav>

        <div class="container">
            <h2 class="text-center">Update Traveler Profile</h2>
            <form method="post" enctype="multipart/form-data" id="profile-form">
                {% csrf_token %}
                <table class="profile-table">
                    <tr>
                        <td class="text-dark"><label for="first_name">First Name:</label></td>
                        <td class="text-dark">
                            <input type="text" name="first_name" id="first_name" required value="{{ profile.first_name }}">
                            <div class="validation-message" id="first-name-validation-message" class="text-danger"></div>
                        </td>
                    </tr>
                    <tr>
                        <td class="text-dark"><label for="last_name">Last Name:</label></td>
                        <td class="text-dark">
                            <input type="text" name="last_name" id="last_name" required value="{{ profile.last_name }}">
                            <div class="validation-message" id="last-name-validation-message" class="text-danger"></div>
                        </td>
                    </tr>
                    <tr>
                        <td class="text-dark"><label for="phone_number">Phone Number:</label></td>
                        <td class="text-dark">
                            <input type="text" name="phone_number" id="phone_number" required value="{{ profile.phone_number }}">
                            <div class="validation-message" id="phone-number-validation-message" class="text-danger"></div>
                        </td>
                    </tr>
                    <tr>
                        <td class="text-dark"><label for="gender">Gender:</label></td>
                        <td class="text-dark">
                            <select name="gender" id="gender" required>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                                <option value="other">Other</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td class="text-dark"><label for="country">Country:</label></td>
                        <td class="text-dark">
                            <input type="text" name ="country" id="country" required value="{{ profile.country }}">
                            <div class="validation-message" id="country-validation-message" class="text-danger"></div>
                        </td>
                    </tr>
                    <tr>
                        <td class="text-dark"><label for="profile_photo">Profile Photo:</label></td>
                        <td>
                            <!-- Display the current profile photo -->
                            {% if profile.profile_photo %}
                                <img src="{{ profile.profile_photo.url }}" alt="Current Profile Photo" width="150px" height="100px">
                            {% else %}
                                <p>No profile photo available</p>
                            {% endif %}
                        
                            <!-- Input for uploading a new profile photo -->
                            <input type="file" name="profile_photo" id="profile_photo" accept=".jpg">
                            <div class="validation-message" id="profile-photo-validation-message" class="text-danger"></div>
                        </td>
                    </tr>
                </table>
                <button type="submit" id="update-profile-button">Update Profile</button>
            </form>
            
            <script>
                // Get references to the input fields and their respective validation messages
                const firstNameInput = document.getElementById('first_name');
                const firstNameValidationMessage = document.getElementById('first-name-validation-message');
                const lastNameInput = document.getElementById('last_name');
                const lastNameValidationMessage = document.getElementById('last-name-validation-message');
                const phoneNumberInput = document.getElementById('phone_number');
                const phoneNumberValidationMessage = document.getElementById('phone-number-validation-message');
                const profilePhotoInput = document.getElementById('profile_photo');
                const profilePhotoValidationMessage = document.getElementById('profile-photo-validation-message');
                const countryInput = document.getElementById('country');
                const countryValidationMessage = document.getElementById('country-validation-message');
            
                // Add input event listeners for real-time validation
                firstNameInput.addEventListener('input', validateFirstName);
                lastNameInput.addEventListener('input', validateLastName);
                phoneNumberInput.addEventListener('input', validatePhoneNumber);
                profilePhotoInput.addEventListener('input', validateProfilePhoto);
                countryInput.addEventListener('input', validateCountry);
            
                // Validation functions
                function validateFirstName() {
    const firstName = firstNameInput.value.trim();
    if (firstName === '') {
        firstNameValidationMessage.textContent = 'First Name is required.';
    } else if (!/^[a-zA-Z]+$/.test(firstName)) {
        firstNameValidationMessage.textContent = 'First Name can only contain letters.';
    } else {
        firstNameValidationMessage.textContent = '';
    }
}

            
function validateLastName() {
    const lastName = lastNameInput.value.trim();
    if (lastName === '') {
        lastNameValidationMessage.textContent = 'Last Name is required.';
    } else if (!/^[a-zA-Z]+$/.test(lastName)) {
        lastNameValidationMessage.textContent = 'Last Name can only contain letters.';
    } else {
        lastNameValidationMessage.textContent = '';
    }
}

            
                function validatePhoneNumber() {
    const phoneNumber = phoneNumberInput.value.trim();
    
    if (phoneNumber === '') {
        phoneNumberValidationMessage.textContent = 'Phone Number is required.';
    } else if (!/^[6-9]\d{9}$/.test(phoneNumber)) {
        phoneNumberValidationMessage.textContent = 'Phone Number should contain 10 digits and not start with 0, 1, 2, 3, 4, or 5.';
    } else {
        phoneNumberValidationMessage.textContent = '';
    }
}

            
                function validateProfilePhoto() {
                    if (profilePhotoInput.files.length === 0) {
                        profilePhotoValidationMessage.textContent = 'Profile Photo is required.';
                    } else {
                        profilePhotoValidationMessage.textContent = '';
                    }
                }
            
                function validateCountry() {
    const country = countryInput.value.trim();
    if (country === '') {
        countryValidationMessage.textContent = 'Country is required.';
    } else if (!/^[a-zA-Z\s]+$/.test(country)) {
        countryValidationMessage.textContent = 'Country can only contain letters and spaces.';
    } else {
        countryValidationMessage.textContent = '';
    }
}

            
                // Handle form submission
                const form = document.getElementById('profile-form');
                form.addEventListener('submit', function (event) {
                    // Perform validation before form submission
                    validateFirstName();
                    validateLastName();
                    validatePhoneNumber();
                    validateProfilePhoto();
                    validateCountry();
            
                    // Check if any validation messages are displayed
                    if (
                        firstNameValidationMessage.textContent ||
                        lastNameValidationMessage.textContent ||
                        phoneNumberValidationMessage.textContent ||
                        profilePhotoValidationMessage.textContent ||
                        countryValidationMessage.textContent
                    ) {
                        event.preventDefault(); // Prevent form submission
                    }
                });
            </script>
            
            
            
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
            <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
        
</body>
</html>
